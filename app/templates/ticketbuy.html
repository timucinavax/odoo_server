<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Uçuş Seçimi</title>
    <style>
      /* Genel Stil */
      body {
        font-family: Arial, sans-serif;
        background-color: #fff;
        margin: 0;
        padding: 0;
      }

      .navbar {
        background-color: #004080;
        color: white;
        padding: 15px;
        text-align: center;
        font-size: 1.5rem;
      }

      .breadcrumb-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background-color: #fff;
        padding: 15px;
        border-bottom: 1px solid #ddd;
      }

      .breadcrumb-item {
        text-align: center;
        flex: 1;
        cursor: pointer;
        padding: 10px;
        color: #004080;
        background-color: #e9ecef;
        border-radius: 5px;
        transition: background-color 0.3s, color 0.3s;
      }

      .breadcrumb-item.active {
        background-color: #dc3545;
        color: white;
      }

      .date-selector {
        display: flex;
        justify-content: center;
        padding: 15px;
        background-color: #fff;
        overflow-x: auto;
        border-bottom: 1px solid #ddd;
      }

      .date-box {
        text-align: center;
        padding: 10px;
        margin: 5px;
        border-radius: 8px;
        border: 1px solid #ddd;
        background-color: #f9f9f9;
        min-width: 100px;
        cursor: pointer;
        transition: background-color 0.3s, color 0.3s;
      }

      .date-box.active {
        background-color: #dc3545;
        color: white;
      }

      .flights-container {
        padding: 15px;
      }

      .card {
        display: flex;
        margin-bottom: 20px;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      .card-left,
      .card-right {
        background-color: #ffffff;
        padding: 20px;
      }

      .card-left {
        width: 450px;
      }

      .card-right {
        width: 200px;
        border-left: 1px dashed #ccc;
        text-align: center;
      }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-bottom: 15px;
      }

      .header img {
        width: 100px;
      }

      .barcode img {
        height: 50px;
        width: 150px;
        transform: rotate(90deg);
      }

      .main-details,
      .flight-details {
        margin-top: 20px;
      }

      .centered {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
      }

      .centered p {
        margin: 0 10px;
      }

      .flight-details p {
        font-weight: bold;
      }

      .heading {
        font-size: 12px;
        color: #acadaf;
        text-transform: uppercase;
      }

      .price {
        font-size: 1.5rem;
        font-weight: bold;
        color: #28a745;
        text-align: right;
      }

      .buy-ticket-button {
        background-color: #dc3545;
        color: white;
        border: none;
        border-radius: 5px;
        padding: 10px 20px;
        font-size: 1rem;
        cursor: pointer;
        transition: background-color 0.3s;
        align-self: flex-end;
      }

      .buy-ticket-button:hover {
        background-color: #c82333;
      }
    </style>
  </head>
  <body>
    <div class="navbar">SEHLEN TURİZM</div>

    <div class="breadcrumb-container">
      <div class="breadcrumb-item active" data-number="0">Uçuş seçimi</div>
      <div class="breadcrumb-item" data-number="1">Yolcu bilgileri</div>
      <div class="breadcrumb-item" data-number="2">Ek hizmetler</div>
      <div class="breadcrumb-item" data-number="3">Ödeme</div>
    </div>

    <div class="date-selector">
      {% for date in dates %}
      <div class="date-box" onclick="showFlights('{{ date }}')">
        <div class="day-number">{{ date.split('-')[2] }}</div>
        <div class="day-name">{{ date | dayname }}</div>
        <div class="month-name">{{ date | monthname }}</div>
        <div class="price">TRY {{ date_prices[date] }}</div>
      </div>
      {% endfor %}
    </div>

    <div class="flights-container" id="flights-container"></div>

    <script>
        const flightsData = {{ flights|tojson }};

        function showFlights(date) {
            document.querySelectorAll('.date-box').forEach(box => box.classList.remove('active'));
            document.querySelector(`.date-box[onclick="showFlights('${date}')"]`).classList.add('active');

            const flightsContainer = document.getElementById('flights-container');
            flightsContainer.innerHTML = '';

            const flights = flightsData.filter(flight => flight.departure_time.startsWith(date));

            if (flights.length > 0) {
                flights.forEach(flight => {
                    const flightCard = `
                      <div class="card">
                        <div class="card-left">
                          <header class="header">
                            <img src="https://logodownload.org/wp-content/uploads/2019/05/air-france-logo-1.png"/>
                            <h5>BUSINESS CLASS</h5>
                          </header>
                          <main>
                            <div class="barcode">
                                <img src="https://www.freepnglogos.com/uploads/barcode-png/barcode-laser-code-vector-graphic-pixabay-3.png" />
                            </div>
                            <section class="main-details">
                              <p><span class="heading">Yolcu</span><br>${flight.passenger_name}</p>
                              <div class="centered">
                                <p><span class="heading">Nereden</span><br>${flight.departure_airport}</p>
                                &#8594;
                                <p><span class="heading">Nereye</span><br>${flight.arrival_airport}</p>
                                <p><span class="heading">Tarih</span><br>${flight.date}</p>
                              </div>
                              <div class="flight-details">
                                <p><span class="heading">Uçuş</span><br>${flight.flight_code}</p>
                                <p><span class="heading">Kalkış</span><br>${flight.departure_time}</p>
                                <p><span class="heading">Kapı</span><br>${flight.gate}</p>
                                <p><span class="heading">Koltuk</span><br>${flight.seat}</p>
                              </div>
                              <h5>Kalkıştan 20 dakika önce kapılar kapanır.</h5>
                            </section>
                          </main>
                        </div>
                        <div class="card-right">
                          <header class="header">
                            <img src="https://logodownload.org/wp-content/uploads/2019/05/air-france-logo-1.png"/>
                          </header>
                          <main>
                            <div class="centered">
                              <p><span class="heading">Yolcu</span><br>${flight.passenger_name}</p>
                              <p><span class="heading">Koltuk</span><br>${flight.seat}</p>
                            </div>
                            <div class="centered">
                              <p><span class="heading">Nereden</span><br>${flight.departure_city}</p>
                              &#8594;
                              <p><span class="heading">Nereye</span><br>${flight.arrival_city}</p>
                            </div>
                            <div class="centered">
                              <p><span class="heading">Uçuş</span><br>${flight.flight_code}</p>
                              <p><span class="heading">Tarih</span><br>${flight.date}</p>
                            </div>
                          </main>
                        </div>
                      </div>
                    `;
                    flightsContainer.innerHTML += flightCard;
                });
            } else {
                flightsContainer.innerHTML = '<div class="no-flights">Bu tarihte uçuş bulunmamaktadır.</div>';
            }
        }

        function buyTicket(flightCode) {
            alert(`Flight code: ${flightCode} için bilet alındı.`);
        }

        function calculateFlightDuration(departureTime, arrivalTime) {
          const departure = new Date(departureTime);
          const arrival = new Date(arrivalTime);
          const duration = new Date(arrival - departure);

          const hours = Math.floor(duration / (1000 * 60 * 60));
          const minutes = Math.floor((duration % (1000 * 60 * 60)) / (1000 * 60));

          return `${hours}h ${minutes}m`;
      }
    </script>
  </body>
</html>
